

# æ•°å­—è—å“äº¤æ˜“å¹³å°æŠ€èƒ½

**ä½œè€…ï¼šYanShijie**

---

## 1.è‡ªå®šä¹‰æ³¨è§£ + AOP



## 2.ç­–ç•¥ + æ¨¡æ¿ + å·¥å‚è®¾è®¡æ¨¡å¼

### 2.1 ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰

#### 1ï¸âƒ£ æ˜¯ä»€ä¹ˆ

> **æŠŠä¸€ç»„â€œå¯äº’æ¢çš„ç®—æ³•â€å°è£…æˆç‹¬ç«‹çš„ç­–ç•¥ç±»ï¼Œå¯¹å¤–æš´éœ²ç»Ÿä¸€æ¥å£**ï¼Œ**åŒä¸€ä»¶äº‹ï¼Œå¤šç§åšæ³•ï¼Œè¿è¡Œæ—¶è‡ªç”±åˆ‡æ¢**

#### 2ï¸âƒ£ è§£å†³ä»€ä¹ˆé—®é¢˜

1. if / else / switch è¶Šå†™è¶Šå¤š
2. ä¸åŒä¸šåŠ¡è§„åˆ™ï¼Œä½†æ‰§è¡Œå…¥å£ä¸€è‡´
3. æ–°å¢è§„åˆ™ä¸æƒ³æ”¹è€ä»£ç ï¼ˆ**å¼€é—­åŸåˆ™**ï¼‰

âŒ åå‘³é“

```java
if (payType == 1) {
    wechatPay();
} else if (payType == 2) {
    alipay();
} else if (payType == 3) {
    bankPay();
}
```

#### 3ï¸âƒ£ ç»“æ„ & ç¤ºä¾‹ï¼ˆJavaï¼‰

1. ç­–ç•¥æ¥å£

```java
public interface PayStrategy {
    void pay(Long amount);
}
```

2. å¤šä¸ªç­–ç•¥å®ç°

```java
@Component("WECHAT")
public class WechatPayStrategy implements PayStrategy {
    public void pay(Long amount) {
        System.out.println("å¾®ä¿¡æ”¯ä»˜ï¼š" + amount);
    }
}

@Component("ALIPAY")
public class AlipayPayStrategy implements PayStrategy {
    public void pay(Long amount) {
        System.out.println("æ”¯ä»˜å®æ”¯ä»˜ï¼š" + amount);
    }
}
```

3. ç­–ç•¥ä½¿ç”¨æ–¹

```java
@Service
public class PayService {

    @Autowired
    private Map<String, PayStrategy> strategyMap;

    public void pay(String type, Long amount) {
        strategyMap.get(type).pay(amount);
    }
}
```

ğŸ‘‰ **Spring å¤©ç„¶é€‚é…ç­–ç•¥æ¨¡å¼ï¼ˆMap æ³¨å…¥ï¼‰**

#### 4ï¸âƒ£ é€‚ç”¨åœºæ™¯

1. æ”¯ä»˜æ–¹å¼
2. ä¸Šé“¾ç­–ç•¥ï¼ˆETH / æ–‡æ˜Œé“¾ / ç§æœ‰é“¾ï¼‰
3. é£æ§è§„åˆ™
4. è®¡è´¹ç­–ç•¥
5. NFT é“¸é€ ç­–ç•¥

### 2.2 æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Method Patternï¼‰

#### 1ï¸âƒ£ æ˜¯ä»€ä¹ˆ

> **å®šä¹‰ç®—æ³•éª¨æ¶ï¼ŒæŠŠå¯å˜æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»å®ç°**,**æµç¨‹å›ºå®šï¼Œæ­¥éª¤å¯å˜**

------

#### 2ï¸âƒ£ è§£å†³ä»€ä¹ˆé—®é¢˜

1. å¤šä¸ªå­ç±»æµç¨‹é«˜åº¦ä¸€è‡´
2. åªå·®å‡ ä¸ªæ­¥éª¤ä¸åŒ
3. ä¸æƒ³æ¯ä¸ªå­ç±»éƒ½ copy ä¸€å¥—æµç¨‹

âŒ åå‘³é“

```java
public void processA() {
    step1();
    step2A();
    step3();
}

public void processB() {
    step1();
    step2B();
    step3();
}
```

------

#### 3ï¸âƒ£ ç»“æ„ & ç¤ºä¾‹ï¼ˆJavaï¼‰

1. æŠ½è±¡æ¨¡æ¿

```java
public abstract class AbstractMintService {

    public final void mint() {
        validate();
        uploadMetadata();
        onChain();
        afterMint();
    }

    protected abstract void onChain();

    protected void validate() {}
    protected void uploadMetadata() {}
    protected void afterMint() {}
}
```

2. å­ç±»å®ç°å·®å¼‚æ­¥éª¤

```java
@Service
public class WenChangMintService extends AbstractMintService {
    protected void onChain() {
        System.out.println("æ–‡æ˜Œé“¾ä¸Šé“¾");
    }
}

@Service
public class EthMintService extends AbstractMintService {
    protected void onChain() {
        System.out.println("ETH ä¸Šé“¾");
    }
}
```

#### 4ï¸âƒ£ é€‚ç”¨åœºæ™¯

1. è®¢å•å¤„ç†æµç¨‹
2. ä¸Šé“¾æµç¨‹
3. æ•°æ®å¯¼å…¥å¯¼å‡º
4. æ‰¹å¤„ç†ä»»åŠ¡
5. å®¡æ‰¹æµç¨‹

### 2.3 å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰

#### 1ï¸âƒ£ æ˜¯ä»€ä¹ˆ

> **å°è£…å¯¹è±¡åˆ›å»ºé€»è¾‘ï¼Œå¯¹å¤–éšè— newï¼Œä½ è¦ä»€ä¹ˆå¯¹è±¡ï¼Œä¸å…³å¿ƒæ€ä¹ˆåˆ›å»º**

------

#### 2ï¸âƒ£ è§£å†³ä»€ä¹ˆé—®é¢˜

1. new å†™å¾—åˆ°å¤„éƒ½æ˜¯
2. åˆ›å»ºé€»è¾‘å¤æ‚
3. å¯¹è±¡ç±»å‹ç»å¸¸å˜åŒ–

âŒ åå‘³é“

```java
if (type.equals("ETH")) {
    return new EthChainService();
}
```

------

#### 3ï¸âƒ£ ç»“æ„ & ç¤ºä¾‹ï¼ˆSpring å·¥å‚ï¼‰

```java
@Component
public class BlockchainServiceFactory {

    private final Map<String, BlockchainService> serviceMap;

    public BlockchainServiceFactory(List<BlockchainService> services) {
        serviceMap = services.stream()
            .collect(Collectors.toMap(
                BlockchainService::supportType,
                Function.identity()
            ));
    }

    public BlockchainService get(String type) {
        return serviceMap.get(type);
    }
}
```

ä½¿ç”¨ï¼š

```java
factory.get("ETH").mint();
```



