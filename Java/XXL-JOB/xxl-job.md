# XXL-JOB ç¬”è®°

ä½œè€…ï¼šYan

---

## ä¸€ã€ğŸ“ FRP å†…ç½‘ç©¿é€ + XXL-JOB æ‰§è¡Œå™¨è°ƒè¯•ç¬”è®°

## ğŸ”¹ åœºæ™¯

- **è°ƒåº¦ä¸­å¿ƒï¼ˆxxl-job-adminï¼‰**ï¼šéƒ¨ç½²åœ¨äº‘æœåŠ¡å™¨ï¼ˆå…¬ç½‘å¯è®¿é—®ï¼Œç«¯å£ 9002ï¼‰ã€‚
- **æ‰§è¡Œå™¨ï¼ˆSpringBoot é¡¹ç›®ï¼‰**ï¼šè¿è¡Œåœ¨æœ¬åœ°ç¬”è®°æœ¬ï¼ˆç›‘å¬ 9999 ç«¯å£ï¼‰ã€‚
- **é—®é¢˜**ï¼šè°ƒåº¦ä¸­å¿ƒéœ€è¦å›è°ƒæ‰§è¡Œå™¨ï¼Œä½†ç¬”è®°æœ¬é€šå¸¸æ²¡æœ‰å…¬ç½‘ IPï¼Œäº‘ä¸Šæ— æ³•ç›´è¿æœ¬åœ° `9999`ã€‚
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨ **FRP å†…ç½‘ç©¿é€**ï¼Œåœ¨äº‘æœåŠ¡å™¨å’Œæœ¬åœ°ä¹‹é—´å»ºç«‹ä¸€æ¡éš§é“ï¼ŒæŠŠæœ¬æœº `9999` æ˜ å°„æˆäº‘æœåŠ¡å™¨çš„ `19999` ç«¯å£ï¼Œä¾›è°ƒåº¦ä¸­å¿ƒè®¿é—®ã€‚

## ğŸ”¹ åŸå› 

1. **ç½‘ç»œéš”ç¦»**
   - æœ¬åœ°ç¬”è®°æœ¬ä¸€èˆ¬åœ¨ NAT/è·¯ç”±å™¨åï¼Œæ²¡æœ‰å…¬ç½‘ IPã€‚
   - äº‘æœåŠ¡å™¨æ— æ³•ç›´æ¥è®¿é—®åˆ°æœ¬æœºç«¯å£ï¼ˆ9999ï¼‰ã€‚
2. **è°ƒåº¦ä¸­å¿ƒè®¿é—®æœºåˆ¶**
   - è°ƒåº¦ä¸­å¿ƒè§¦å‘ä»»åŠ¡æ—¶ï¼Œä¼šæ ¹æ®æ‰§è¡Œå™¨æ³¨å†Œåœ°å€ï¼ˆ`xxl.job.executor.address`ï¼‰æ¥è¯·æ±‚æ‰§è¡Œå™¨çš„ HTTP æœåŠ¡ã€‚
   - å¦‚æœè¿™ä¸ªåœ°å€æ˜¯å†…ç½‘ IPï¼ˆå¦‚ `192.168.x.x`ï¼‰ï¼Œäº‘æœåŠ¡å™¨æ ¹æœ¬è®¿é—®ä¸åˆ° â†’ æ‰§è¡Œå™¨ç¦»çº¿/è°ƒåº¦å¤±è´¥ã€‚
3. **FRP çš„ä½œç”¨**
   - **frps**ï¼ˆæœåŠ¡ç«¯ï¼Œè·‘åœ¨äº‘æœåŠ¡å™¨ï¼‰ç›‘å¬å›ºå®šç«¯å£ï¼ˆå¦‚ 19999ï¼‰ã€‚
   - **frpc**ï¼ˆå®¢æˆ·ç«¯ï¼Œè·‘åœ¨æœ¬æœºï¼‰ä¸»åŠ¨è¿ä¸Š frpsï¼ŒæŠŠæœ¬æœº `9999` æ˜ å°„åˆ°äº‘ç«¯ `19999`ã€‚
   - å¤–éƒ¨ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰è®¿é—® `http://äº‘IP:19999` â†’ frps â†’ frpc â†’ æœ¬åœ° `9999`ã€‚
   - ç›¸å½“äºç»™æœ¬æœºæ‰§è¡Œå™¨â€œå¥—â€äº†ä¸€ä¸ªäº‘ç«¯çš„å…¬ç½‘ç«¯å£ã€‚

## ğŸ”¹ è§£å†³æ–¹å¼

1. åˆ›å»º`FRP`æ–‡ä»¶å¤¹

```bash
mkdir -p /opt/frp
cd /opt/frp
```

2. æ–°å»º `frps.ini`æ–‡ä»¶

```ini
[common]
bind_port = 7000
token = frp-very-secret

# å¯é€‰ï¼šDashboard é¢æ¿
dashboard_port = 7500
dashboard_user = admin
dashboard_pwd = admin123

# å¯é€‰ï¼šé™åˆ¶åªå…è®¸ 19999 ç«¯å£æ˜ å°„
allow_ports = 19999
```

3. Docker å¯åŠ¨FRPï¼Œåœ¨ `/opt/frp` ä¸‹æ‰§è¡Œï¼š

```bash
docker run -d --name frps --restart unless-stopped \
  -p 7000:7000 -p 7500:7500 -p 19999:19999 \
  -v /opt/frp/frps.ini:/etc/frp/frps.ini \
  snowdreamtech/frps:latest -c /etc/frp/frps.ini
```

```java
/**
è¯´æ˜ï¼š
    -p 7000:7000 â†’ frpc å®¢æˆ·ç«¯è¿ frps ç”¨
    -p 7500:7500 â†’ Dashboardï¼ˆå¯é€‰ï¼‰
    -p 19999:19999 â†’ ä½ æœ¬æœºæ‰§è¡Œå™¨ 9999 å°†è¢«æ˜ å°„æˆäº‘ç«¯ 19999
    -v /opt/frp/frps.ini:/etc/frp/frps.ini â†’ æŠŠä½ å†™å¥½çš„é…ç½®æ–‡ä»¶æŒ‚è½½è¿›å»	
*/
```

4. windowsï¼ˆæœ¬æœºï¼‰ä¸‹è½½FRPC

> https://github.com/fatedier/frp/releases

5. æ–°å»º `D:\frp\frpc.ini`ï¼ˆç¡®ä¿ token ä¸ frps.ini ç›¸åŒï¼‰

```ini
[common]
server_addr = 49.233.93.83
server_port = 7000
token = frp-very-secret

[xxl-job-executor]
type = tcp
local_ip = 127.0.0.1
local_port = 9999
remote_port = 19999
```

6. å¯åŠ¨FRP

```bash
cd /d D:\frp
frpc.exe -c frpc.ini
```

7. æŠŠæ‰§è¡Œå™¨æ³¨å†Œåœ°å€æ”¹ä¸º äº‘IP + remote_portï¼š

```yaml
xxl:
  job:
    admin:
      addresses: http://49.233.93.83:9002/xxl-job-admin
      accessToken: pingzhuyan.test
    executor:
      appname: xxl-job-executor-sample
      address: http://49.233.93.83:19999   # â˜… å…³é”®ï¼šç”¨äº‘ç«¯çš„ 19999
      ip:
      port: 9999                           # æœ¬åœ°ä»ç›‘å¬ 9999
      logpath: ./logs/xxl-job/jobhandler
      logretentiondays: 30
```

